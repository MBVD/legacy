# Основы NASM

## Установка и компиляция

Для работы с NASM требуется:

- `nasm`
- `gcc`
- `build-essential`

## Секции памяти

### Основные секции

```assembly
section .text   ; Код программы, инструкции
section .data   ; Инициализированные данные (например, int y = 1)
section .bss    ; Неинициализированные данные (например, int x, по умолчанию x=0)
section .heap   ; Динамическая память (используется malloc)
```

Подробнее: [Секции памяти](https://bstudy.net/949084/tehnika/sektsii_pamyati)

## Ввод и вывод (printf и write)

```assembly
%include "io64.inc"
```

### Макросы для работы с вводом/выводом:

- `GET_DEC`
- `PRINT_DEC`
- `PRINT_UDEC`, `GET_UDEC`
- `PRINT_CHAR`
- `GET_CHAR`
- `PRINT_STRING`
- `NEWLINE`

### Пример использования

```assembly
GET_DEC 8, rax   ; Получить 8-байтовое число
PRINT_DEC rax    ; Вывести число
PRINT_STRING msg ; Вывести строку
NEWLINE
```

Для комментариев используется `;`

## Устройство процессора

### Виды памяти:

- **Внешняя память**: Жесткий диск, флеш, SSD
- **Внутренняя память**: ОЗУ
- **Кэш-память**: L1, L2

**Частота процессора** измеряется в Гц (Hz).

## Регистры

### 1. Регистры общего назначения (8/4/2/1 байт)

```assembly
rax/eax/ax/al   ; Основной регистр
rbx/ebx/bx/bl   ; Второй регистр
rcx/ecx/cx/cl   ; Счетчик
rdx/edx/dx/dl   ; Данные
```

### 2. Индексные регистры

```assembly
rsi  ; Источник
rdi  ; Назначение
```

### 3. Регистры стека

```assembly
rsp  ; Stack Pointer (указатель стека, запрещено изменять)
rbp  ; Base Pointer (вспомогательный регистр)
```

### 4. Регистры управления

```assembly
rip  ; Instruction Pointer (указатель текущей инструкции)
```

### 5. Дополнительные регистры

```assembly
r8 - r12  ; Расширенные регистры
```

### 6. Флаги состояния

```assembly
rflags  ; Регистр флагов
```

### 7. Регистры SIMD

```assembly
xmm, ymm  ; Векторные регистры (операции с плавающей точкой)
```

## Создание переменных

### Объявление переменных

```assembly
section .data
x db 1       ; x = 1 (1 байт)
y dw 10      ; y = 10 (2 байта)
mas db 1, 2, 3, 4  ; массив
str db 'h', 'e', 'l', 'l', 'o'
str1 db "Hello", 0  ; строка с нулевым символом
pi equ 3.14  ; Константа
```

```assembly
section .bss
x resb 1    ; Выделение памяти без инициализации
```

## Виды операндов

### Основные типы операндов

1. **Регистры** (R)
2. **Объекты из памяти** (M) - `.data`, `.bss`
3. **Константы** (C) - непосредственные значения

**Примеры:**

```assembly
mov rax, rbx  ; R, R
mov rax, [x]  ; R, M (взять значение из памяти)
mov [x], 2    ; M, C (записать константу в память)
```

## Операция присваивания

```assembly
mov rax, rbx  ; rax = rbx
mov rax, [x]  ; Взять значение x
mov byte [x], 2  ; Записать 2 в x
```

## Арифметические операции

### Сложение

```assembly
add op1, op2  ; op1 = op1 + op2
```

### Вычитание

```assembly
sub op1, op2  ; op1 = op1 - op2
```

## Домашка

4. Написать программу для считывания трех чисел с клавиатуры.
5. Вычислить сумму и разность этих чисел.
6. Поместить результат в регистр и вывести его.
7. Поместить результат в память и вывести его.